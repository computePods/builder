# This CEKit module describes how to install the base debian system into a pde

# This module:
# - assumes a Debian based container,

# see: https://github.com/nats-io/nats-docker/tree/master/2.2.1

schema_version: 1

name: syncThingServer
version: 1.0
description: Installs the SyncThing file syncrhonization service
from: alpine

execute:
  - script: installSyncThing.sh

packages:
  manager: apk
  install:
    - ca-certificates

run:
  cmd:
    - syncthing
    - '--logfile'
    - '/tmp/syncthing.log'

artifacts:
  # The goLang binaries built in the builder image
  - name: goLangSyncThing
    image: builder
    path: /root/syncthing/bin/syncthing
    target: syncthing

  - name: config.xml
    path: config.xml
    target: config.xml
    
# Tell cpb that we have a two stage build which requires the
# syncThingBuild module
#
buildModule: syncThingServerBuild
